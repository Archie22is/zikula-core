<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Zikula Core</title>
        <link rel="stylesheet" href="https://docs.ziku.la/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://docs.ziku.la/css/font-awesome.min.css">
        <link rel="stylesheet" href="https://docs.ziku.la/css/highlight.tomorrow-night.css">
        <link rel="stylesheet" href="https://docs.ziku.la/css/main.css">

        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
        <link rel="manifest" href="/site.webmanifest">
        <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
        <meta name="msapplication-TileColor" content="#da532c">
        <meta name="theme-color" content="#ffffff">
    </head>
    <body>
        <header class="navbar fixed-top navbar-dark bg-dark">
            <a class="navbar-brand" href="https://docs.ziku.la/">
                Zikula Core
                <small class="d-none d-lg-inline">
                    Zikula CMS and Symfony framework
                </small>
            </a>
                            <a href="https://github.com/zikula/core">
                    <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://docs.ziku.la/images/fork.png" alt="Fork me on GitHub" />
                </a>
                    </header>
        <main class="container-fluid">
            <div class="row">
                                    <nav id="sidebar" class="col-md-3 col-xl-2" role="navigation">
                                                    <p class="text-muted">
                                General
                            </p>
                            <ul class="nav flex-column">
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/index.html" class="nav-link">
                                            Home page
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/features.html" class="nav-link">
                                            Features
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/roadmap.html" class="nav-link">
                                            Roadmap
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/requirements.html" class="nav-link">
                                            Requirements
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/install.html" class="nav-link">
                                            Installation
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/upgrade.html" class="nav-link">
                                            Upgrade
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Contributing/index.html" class="nav-link">
                                            Contributing
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Releases/index.html" class="nav-link">
                                            Releases
                                        </a>
                                    </li>
                                                            </ul>
                                                    <p class="text-muted">
                                Administrators
                            </p>
                            <ul class="nav flex-column">
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Admin/index.html" class="nav-link">
                                            Overview
                                        </a>
                                    </li>
                                                            </ul>
                                                    <p class="text-muted">
                                Developers
                            </p>
                            <ul class="nav flex-column">
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Developer/index.html" class="nav-link">
                                            Overview
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Developer/Api/index.html" class="nav-link">
                                            APIs
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Developer/Categories/index.html" class="nav-link">
                                            Categories
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Developer/Doctrine/index.html" class="nav-link">
                                            Doctrine
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Developer/Events/index.html" class="nav-link">
                                            Events
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Developer/Forms/index.html" class="nav-link active">
                                            Forms
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Developer/Hooks/index.html" class="nav-link">
                                            Hooks
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Developer/ModuleInterfaces/index.html" class="nav-link">
                                            Module interfaces
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Developer/Traits/index.html" class="nav-link">
                                            Traits
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Developer/UsersAndAuthentication/index.html" class="nav-link">
                                            Users and authentication
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Developer/OtherTopics/index.html" class="nav-link">
                                            Other topics
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Developer/ExtensionDevelopment/index.html" class="nav-link">
                                            Extension Development
                                        </a>
                                    </li>
                                                            </ul>
                                                    <p class="text-muted">
                                Further topics
                            </p>
                            <ul class="nav flex-column">
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Translation/index.html" class="nav-link">
                                            Translation
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Menu/index.html" class="nav-link">
                                            Menus
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Themes/index.html" class="nav-link">
                                            Themes
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/templatesandassets.html" class="nav-link">
                                            Templates and Assets
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Twig/index.html" class="nav-link">
                                            Twig
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://docs.ziku.la/Workflows/workflows.html" class="nav-link">
                                            Workflows
                                        </a>
                                    </li>
                                                            </ul>
                                                    <p class="text-muted">
                                Resources
                            </p>
                            <ul class="nav flex-column">
                                                                    <li class="nav-item">
                                        <a href="https://ziku.la" class="nav-link">
                                            Zikula website
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://github.com/zikula/core" class="nav-link">
                                            <i class="fab fa-github"></i> GitHub
                                        </a>
                                    </li>
                                                                    <li class="nav-item">
                                        <a href="https://joinslack.ziku.la/" class="nav-link">
                                            <i class="fab fa-slack"></i> Slack
                                        </a>
                                    </li>
                                                            </ul>
                                            </nav>
                                <section class="offset-md-3 offset-xl-2 col-md-9 col-xl-10">
                    <h1 id="dynamic-form-fields">Dynamic form fields</h1>
<p>The <code>FormExtensionBundle</code> offers helpers for handling dynamic form fields (<em>properties</em>).
This can be helpful for several applications, like contact form builders or survey modules.
The default Profile module uses this functionality to handle definition and management
of user profile data.</p>
<h2 id="dynamic-selection-of-field-types-and-corresponding-options">Dynamic selection of field types and corresponding options</h2>
<p>The <code>Zikula\Bundle\FormExtensionBundle\Form\Type\DynamicFieldType</code> class provides a form type which
consists of two parts. First a choice field which allows to select a field type using a dropdown list.
Upon selection further field-specific form fields for the field options are loaded using ajax and
dynamically added/replaced in the form. To use this add something like
<code>$builder-&gt;add('fieldInfo', DynamicFieldType::class, ['label' =&gt; false]);</code>
to your form type's <code>buildForm</code> method.</p>
<p>Sometimes you want to amend or extend the field type list. For example profile modules may want
to add an avatar field type. Similarly other custom types may be relevant for other applications.
For this purpose you can listen for an event provided by the
<code>Zikula\Bundle\FormExtensionBundle\Event\FormTypeChoiceEvent</code> class.
Implementation inside your listener might look similar to this example:</p>
<pre><code class="language-php">public function formTypeChoices(FormTypeChoiceEvent $event)
{
    $choices = $event-&gt;getChoices();

    $groupName = $this-&gt;translator-&gt;__('Other Fields', 'zikula');
    if (!isset($choices[$groupName])) {
        $choices[$groupName] = [];
    }

    $groupChoices = $choices[$groupName];
    $groupChoices[$this-&gt;translator-&gt;__('Avatar')] = AvatarType::class;
    $choices[$groupName] = $groupChoices;

    $event-&gt;setChoices($choices);
}</code></pre>
<h2 id="management-and-storage-of-field-definitions">Management and storage of field definitions</h2>
<p>Each module should be able to decide how and where to persist the property data.
The <code>FormExtensionsBundle</code> needs to receive different information though.
Hence, there are two interfaces used for proper communication:</p>
<ol>
<li><code>Zikula\Bundle\FormExtensionBundle\DynamicFieldsContainerInterface</code>
<ul>
<li>Represents a form object (“data_class”) containing dynamic fields.</li>
<li>Provides a list of field specifications by implementing a <code>getDynamicFieldsSpecification()</code> method.</li>
</ul></li>
<li><code>Zikula\Bundle\FormExtensionBundle\DynamicFieldInterface</code>
<ul>
<li>Represents a single field specification.</li>
<li>Provides detail information for the form handling with the following methods:</li>
<li><code>getName()</code> (returns name of form field)</li>
<li><code>getPrefix()</code> (returns optional prefix of form field)</li>
<li><code>getLabels()</code> (returns a list of labels per locale)</li>
<li><code>getLabel($locale = '', $default = 'en')</code> (returns label for a specific locale)</li>
<li><code>getFormType()</code> (returns the FqCN of the form class (e.g. <code>return IntegerType::class;</code>))</li>
<li><code>getFormOptions()</code> (returns an array of form options)</li>
<li><code>getWeight()</code> (returns a weighting number for sorting fields; this is currently not utilised, but reserved for future usage)</li>
<li><code>getGroupNames()</code> (returns a list of group names per locale; may optionally be used for dividing fields into several fieldsets)</li>
</ul></li>
</ol>
<p>This way any module has complete freedom about loading and saving the data (database, YAML file, web service, and so on). At the same time the dynamic fields information are ensured to be provided properly.</p>
<h2 id="loading-and-usage-of-field-definitions">Loading and usage of field definitions</h2>
<p>Another form type implemented by the <code>Zikula\Bundle\FormExtensionBundle\Form\Type\InlineFormDefinitionType</code> class
allows for central inclusion of the dynamic sub part of a form (e.g. profile fields). So a module can just use one
form type for adding the defined fields for a given data object form.</p>
<p>Example:</p>
<pre><code class="language-php">$formBuilder-&gt;add('dynamicFields', InlineFormDefinitionType::class, [
    'dynamicFieldsContainer' =&gt; $this-&gt;propertyRepository,
    'translator' =&gt; $this-&gt;translator,
    'label' =&gt; false,
    'inherit_data' =&gt; true
]);</code></pre>
                </section>
            </div>
        </main>
        <script src="https://docs.ziku.la/js/jquery.min.js"></script>
        <script src="https://docs.ziku.la/js/bootstrap.bundle.min.js"></script>
        <script src="https://docs.ziku.la/js/highlight.pack.js"></script>
        <script>
            $(function() {
                $('section > h1').wrap('<div class="page-header" />');
                                hljs.initHighlightingOnLoad();
                $("a[href^='http']:not([href*='docs.ziku.la'])").attr('target', '_blank');
            });
        </script>
    </body>
</html>
